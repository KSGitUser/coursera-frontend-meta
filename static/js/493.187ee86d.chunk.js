"use strict";(self.webpackChunkcoursera_react_app=self.webpackChunkcoursera_react_app||[]).push([[493],{6353:function(e,t,a){a.r(t),a.d(t,{default:function(){return R},initialAvailableTimes:function(){return T}});var n=a(9439),r=a(1413),i=a(6688),s=a(5023),u=a.p+"static/media/reserve-table-hero-image.eafbe5c8815bd27fbeb9.avif",o=a(4165),l=a(4942),c=a(3433),d=a(5861),m=a(7762),f=a(2791),h=a(1470),p=a(4087),v=a(5946),g=a(2392),x=a(8208),b=a(6069),y=a(8886),j=a(1167),w=a(4125),Z=a(4224),I=function(e){return new Promise((function(t){return setTimeout(t,e)}))},S=function(){var e=(0,f.useState)(!1),t=(0,n.Z)(e,2),a=t[0],r=t[1],i=(0,f.useState)(null),s=(0,n.Z)(i,2),u=s[0],l=s[1],c=function(){var e=(0,d.Z)((0,o.Z)().mark((function e(t,a){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.random(),r(!0),e.prev=2,e.next=5,I(2e3);case 5:if(!(n<.5)){e.next=7;break}throw new Error("Something went wrong");case 7:l({type:"success",message:"Thanks for your submission ".concat(a.firstName,", we will get back to you shortly!")}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),l({type:"error",message:"Something went wrong, please try again later!"});case 13:return e.prev=13,r(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})));return function(t,a){return e.apply(this,arguments)}}();return{isLoading:a,response:u,submit:c}},k=a(2463),_=a(8007),F=a(184),D=[{value:"Birthday",label:"Birthday"},{value:"Anniversary",label:"Anniversary"}],C=function(e){var t=e.availableTimes,a=e.updateTimes,i=e.formDate,s=e.setFormDate,u=e.submitForm,I=S(),C=I.isLoading,M=I.response,N=(0,k.o)().onOpen,E=(0,f.useRef)(null),T=(0,f.useState)(""),q=(0,n.Z)(T,2),A=q[0],R=q[1],J=(0,f.useState)(""),O=(0,n.Z)(J,2),L=O[0],P=O[1],Y=(0,f.useState)(""),z=(0,n.Z)(Y,2),B=z[0],U=z[1],W=(0,f.useState)(""),X=(0,n.Z)(W,2),G=X[0],H=X[1],K=(0,f.useState)({}),Q=(0,n.Z)(K,2),V=Q[0],$=Q[1],ee=(0,f.useMemo)((function(){var e,a=(0,m.Z)(t);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(null!==n&&void 0!==n&&n.selected)return n.value}}catch(r){a.e(r)}finally{a.f()}return""}),[t]),te=function(){var e=(0,d.Z)((0,o.Z)().mark((function e(t){var a,n,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=new FormData(t.target),n=(0,_.Ry)({name:(0,_.Z_)().required(),email:(0,_.Z_)().required().email(),date:(0,_.hT)().default((function(){return new Date})),time:(0,_.Z_)().required(),numberInput:(0,_.Z_)().required(),occasion:(0,_.Z_)().required()}),i={},e.prev=4,$({}),e.next=8,n.validate(Object.fromEntries((0,c.Z)(a.entries())),{abortEarly:!1});case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),i=e.t0.inner.reduce((function(e,t){return(0,r.Z)((0,r.Z)({},e),{},(0,l.Z)({},t.path,t.message))}),{}),$(i);case 14:Object.keys(i).length||u(a);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){if(M){var e=M.type,t=M.message;N(e,t)}}),[M,N]),(0,F.jsx)("div",{spacing:8,children:(0,F.jsx)(h.g,{w:"100%",maxW:"1024px",p:8,alignItems:"flex-start",className:"container",children:(0,F.jsx)(p.xu,{py:6,rounded:"md",w:"100%",children:(0,F.jsx)("form",{ref:function(e){!E.current&&e&&(E.current=e.target)},onSubmit:te,children:(0,F.jsxs)(h.g,{spacing:4,children:[(0,F.jsxs)(p.xu,{w:"100%",children:[(0,F.jsx)(v.X,{variant:"subtitle",mb:6,as:"h2",children:"Reservation data:"}),(0,F.jsxs)(g.NI,{children:[(0,F.jsx)(x.l,{htmlFor:"date",children:"Choose date"}),(0,F.jsx)(b.I,{type:"date",variant:"flushed",id:"date",name:"date",value:i,onChange:function(e){s(e.target.value)}})]}),(0,F.jsxs)(g.NI,{children:[(0,F.jsx)(x.l,{htmlFor:"time",children:"Choose time"}),(0,F.jsx)(y.P,{"data-testid":"form-time-select",variant:"flushed",id:"time",name:"time",value:ee,onChange:function(e){a({type:"set_time",payload:{time:e.target.value,date:i}})},children:t.map((function(e){return(0,F.jsx)("option",{disabled:e.booked,value:e.value,children:e.label},e.value)}))})]}),(0,F.jsxs)(g.NI,{isInvalid:V.numberInput,children:[(0,F.jsx)(x.l,{htmlFor:"numberInput",children:"Choose number of geusts"}),(0,F.jsx)(j.Y2,{variant:"flushed",id:"numberInput",name:"numberInput",min:1,max:10,children:(0,F.jsx)(j.zu,{"data-testid":"form-guests-input",value:A,onChange:function(e){R(e.target.value)}})}),(0,F.jsx)(w.J1,{"data-testid":"form-guests-error",children:V.numberInput})]}),(0,F.jsxs)(g.NI,{isInvalid:V.occasion,children:[(0,F.jsx)(x.l,{htmlFor:"time",children:"Occasion"}),(0,F.jsx)(y.P,{"data-testid":"form-ocassion-select",variant:"flushed",id:"occasion",name:"occasion",value:L,onChange:function(e){P(e.target.value)},children:D.map((function(e){return(0,F.jsx)("option",{value:e.value,children:e.label},e.value)}))}),(0,F.jsx)(w.J1,{children:V.occasion})]}),(0,F.jsxs)(g.NI,{isInvalid:V.name,children:[(0,F.jsx)(x.l,{htmlFor:"name",children:"Name"}),(0,F.jsx)(b.I,{variant:"flushed","data-testid":"form-name-input",id:"name",name:"name",value:B,onChange:function(e){U(e.target.value)}}),(0,F.jsx)(w.J1,{children:V.name})]}),(0,F.jsxs)(g.NI,{isInvalid:V.email,children:[(0,F.jsx)(x.l,{htmlFor:"email",children:"Email:"}),(0,F.jsx)(b.I,{type:"email","data-testid":"form-email-input",variant:"flushed",id:"email",name:"email",value:G,onChange:function(e){H(e.target.value)}}),(0,F.jsx)(w.J1,{children:V.email})]})]}),(0,F.jsx)(Z.z,{"data-testid":"form-submit-button",type:"submit",colorScheme:"purple",width:"full",isLoading:C,"aria-label":"Submit Form",children:"Make Your reservation"})]})})})})})},M=function(e){for(var t=[],a=function(e){var t=Math.pow(2,35)-31,a=e%t;return function(){return(a=185852*a%t)/t}}(e.getDate()),n=17;n<=23;n++)a()<.5&&t.push(n+":00"),a()<.5&&t.push(n+":30");return t},N=a(7689),E={title:"Reserve a table",image:{src:u,alt:"image of food on mane screen"}},T=function(e,t){var a=M(t),n=A(t),r=a.map((function(e){return{value:e,label:e,selected:!1,booked:!1}}));return e.set(n,r),new Map(e)},q=function(e,t){switch(t.type){case"set_time":var a=e.get(t.payload.date).map((function(e){return e.value===t.payload.time?(0,r.Z)((0,r.Z)({},e),{},{selected:!0}):(0,r.Z)((0,r.Z)({},e),{},{selected:!1})}));return e.set(t.payload.date,a),new Map(e);case"new_day":return T(e,t.payload);case"reserve_time":var n=e.get(t.payload.date);return n&&Array.isArray(n)?(n.forEach((function(e){e.value===t.payload.time&&(e.booked=!0),e.selected=!1})),e.set(n),new Map(e)):e}throw Error("Unknown action: "+t.type)};function A(e){var t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),n=String(e.getFullYear());return"".concat(n,"-").concat(t,"-").concat(a)}var R=function(){var e=(0,f.useReducer)(q,new Map,(function(){return T(new Map,new Date)})),t=(0,n.Z)(e,2),a=t[0],r=t[1],u=(0,f.useState)(A(new Date)),o=(0,n.Z)(u,2),l=o[0],c=o[1],d=(0,N.s0)();(0,f.useEffect)((function(){l&&r({type:"new_day",payload:new Date(l)})}),[l]);var m=(0,f.useMemo)((function(){return a.get(l)||[]}),[a,l]);return(0,F.jsxs)(i.Z,{children:[(0,F.jsx)(s.Z,{title:E.title,subtitle:E.subtitle,text:E.text,button:E.button,image:E.image}),(0,F.jsx)(C,{availableTimes:m,updateTimes:r,formDate:l,setFormDate:c,submitForm:function(e){r({type:"reserve_time",payload:{time:e.get("time"),date:e.get("date")}}),d("/confirm")}})]})}}}]);
//# sourceMappingURL=493.187ee86d.chunk.js.map